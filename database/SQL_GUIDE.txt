================================================================================
                    H∆Ø·ªöNG D·∫™N S·ª¨ D·ª§NG SQL SCRIPTS
================================================================================

üìÅ C·∫§U TR√öC FILE SQL
================================================================================

database/
‚îú‚îÄ‚îÄ 01_CREATE_DATABASE.sql      ‚Üê Ch·∫°y TR∆Ø·ªöC TI√äN
‚îú‚îÄ‚îÄ 02_CREATE_VIEWS.sql         ‚Üê Ch·∫°y TH·ª® HAI
‚îú‚îÄ‚îÄ 03_CREATE_PROCEDURES.sql    ‚Üê Ch·∫°y TH·ª® BA
‚îú‚îÄ‚îÄ 04_COMMON_QUERIES.sql       ‚Üê Ch·∫°y TH·ª® T∆Ø
‚îî‚îÄ‚îÄ SQL_GUIDE.txt               ‚Üê File n√†y

================================================================================
üöÄ C√ÅCH CH·∫†Y TR√äN SQL SERVER MANAGEMENT STUDIO (SSMS)
================================================================================

B∆Ø·ªöC 1: M·ªü SSMS
  - K·∫øt n·ªëi ƒë·∫øn SQL Server
  - Ch·ªçn "New Query"

B∆Ø·ªöC 2: Ch·∫°y file 01_CREATE_DATABASE.sql
  - M·ªü file: 01_CREATE_DATABASE.sql
  - Nh·∫•n Ctrl + A ƒë·ªÉ ch·ªçn t·∫•t c·∫£
  - Nh·∫•n Ctrl + E ho·∫∑c F5 ƒë·ªÉ ch·∫°y
  - Ch·ªù ho√†n th√†nh

B∆Ø·ªöC 3: Ch·∫°y file 02_CREATE_VIEWS.sql
  - M·ªü file: 02_CREATE_VIEWS.sql
  - Nh·∫•n Ctrl + A
  - Nh·∫•n F5
  - Ch·ªù ho√†n th√†nh

B∆Ø·ªöC 4: Ch·∫°y file 03_CREATE_PROCEDURES.sql
  - M·ªü file: 03_CREATE_PROCEDURES.sql
  - Nh·∫•n Ctrl + A
  - Nh·∫•n F5
  - Ch·ªù ho√†n th√†nh

B∆Ø·ªöC 5: Ch·∫°y file 04_COMMON_QUERIES.sql
  - M·ªü file: 04_COMMON_QUERIES.sql
  - Ch·ªçn query mu·ªën ch·∫°y
  - Nh·∫•n F5
  - Xem k·∫øt qu·∫£

================================================================================
üìä C·∫§U TR√öC DATABASE
================================================================================

Database: TRA_VINH_PAGODA

B·∫£ng:
  1. Category (Danh m·ª•c)
     - _id (INT, Primary Key)
     - type_name (NVARCHAR)
     - district (NVARCHAR)
     - created_at, updated_at

  2. Pagoda (Ng√¥i ch√πa)
     - _id (INT, Primary Key)
     - name (NVARCHAR)
     - history (NVARCHAR MAX)
     - description (NVARCHAR MAX)
     - address (NVARCHAR)
     - latitude, longitude (FLOAT)
     - category_id (INT, Foreign Key)
     - created_at, updated_at

  3. PagodaImage (·∫¢nh ch√πa)
     - _id (INT, Primary Key)
     - pagoda_id (INT, Foreign Key)
     - image_url (NVARCHAR)
     - image_title (NVARCHAR)
     - display_order (INT)
     - created_at

  4. Post (B√†i vi·∫øt)
     - _id (INT, Primary Key)
     - title (NVARCHAR)
     - content (NVARCHAR MAX)
     - thumbnail (NVARCHAR)
     - author (NVARCHAR)
     - created_at, updated_at

  5. Account (T√†i kho·∫£n Admin)
     - _id (INT, Primary Key)
     - username (NVARCHAR, Unique)
     - password (NVARCHAR)
     - role (NVARCHAR)
     - created_at, updated_at

================================================================================
üìã DANH S√ÅCH QUERIES TH∆Ø·ªúNG D√ôNG
================================================================================

1. L·∫•y t·∫•t c·∫£ ch√πa
   SELECT * FROM Pagoda;

2. L·∫•y ch√πa theo danh m·ª•c
   SELECT p.*, c.type_name FROM Pagoda p
   INNER JOIN Category c ON p.category_id = c._id
   WHERE c.type_name = N'Ch√πa Khmer';

3. L·∫•y chi ti·∫øt ch√πa v·ªõi ·∫£nh
   SELECT p.*, pi.image_url FROM Pagoda p
   LEFT JOIN PagodaImage pi ON p._id = pi.pagoda_id
   WHERE p._id = 1;

4. L·∫•y t·∫•t c·∫£ b√†i vi·∫øt
   SELECT * FROM Post ORDER BY created_at DESC;

5. T√¨m ki·∫øm ch√πa
   SELECT * FROM Pagoda WHERE name LIKE N'%Khmer%';

6. ƒê·∫øm s·ªë ch√πa theo danh m·ª•c
   SELECT c.type_name, COUNT(p._id) AS count
   FROM Category c LEFT JOIN Pagoda p ON c._id = p.category_id
   GROUP BY c.type_name;

7. L·∫•y ch√πa c√≥ nhi·ªÅu ·∫£nh nh·∫•t
   SELECT TOP 5 p._id, p.name, COUNT(pi._id) AS image_count
   FROM Pagoda p LEFT JOIN PagodaImage pi ON p._id = pi.pagoda_id
   GROUP BY p._id, p.name ORDER BY image_count DESC;

8. L·∫•y b√†i vi·∫øt g·∫ßn ƒë√¢y nh·∫•t
   SELECT TOP 5 * FROM Post ORDER BY created_at DESC;

================================================================================
üîß STORED PROCEDURES
================================================================================

1. sp_get_pagoda_by_category
   EXEC sp_get_pagoda_by_category @category_id = 1;

2. sp_get_pagoda_detail
   EXEC sp_get_pagoda_detail @pagoda_id = 1;

3. sp_get_posts
   EXEC sp_get_posts @page_number = 1, @page_size = 10;

4. sp_search_pagoda
   EXEC sp_search_pagoda @search_keyword = N'Khmer';

================================================================================
üëÅÔ∏è VIEWS
================================================================================

1. vw_pagoda_with_category
   SELECT * FROM vw_pagoda_with_category;

2. vw_pagoda_with_image_count
   SELECT * FROM vw_pagoda_with_image_count;

================================================================================
üìà D·ªÆ LI·ªÜU M·∫™U
================================================================================

Categories:
  - Ch√πa Khmer (Tr√† √în, C·∫ßu Ngang)
  - Ch√πa Vi·ªát (Th√†nh ph·ªë Tr√† Vinh)
  - Ch√πa Hoa (Duy√™n H·∫£i)

Pagodas (6 ng√¥i ch√πa):
  1. Ch√πa C√¥ T√¥n
  2. Ch√πa √îng M∆∞·ªùi
  3. Ch√πa Khmer M·∫°c C·ª≠u
  4. Ch√πa C√°i B√®
  5. Ch√πa √îng B√†
  6. Ch√πa M·ªπ Tho

Posts (3 b√†i vi·∫øt):
  1. Kh√°m Ph√° Ki·∫øn Tr√∫c Ch√πa Khmer T·∫°i Tr√† Vinh
  2. L·ªãch S·ª≠ Ph√°t Tri·ªÉn C√°c Ng√¥i Ch√πa T·∫°i Tr√† Vinh
  3. Du L·ªãch T√¢m Linh T·∫°i Tr√† Vinh

Accounts (2 t√†i kho·∫£n):
  - admin
  - editor

================================================================================
üîë KH√ìA NGO·∫†I (FOREIGN KEYS)
================================================================================

Pagoda.category_id ‚Üí Category._id
PagodaImage.pagoda_id ‚Üí Pagoda._id (ON DELETE CASCADE)

================================================================================
üìë CH·ªà M·ª§C (INDEXES)
================================================================================

- idx_pagoda_category: Pagoda(category_id)
- idx_pagoda_image: PagodaImage(pagoda_id)
- idx_post_author: Post(author)
- idx_account_username: Account(username)

================================================================================
üí° TIPS & TRICKS
================================================================================

1. Ki·ªÉm tra d·ªØ li·ªáu
   SELECT COUNT(*) FROM Pagoda;
   SELECT COUNT(*) FROM Category;
   SELECT COUNT(*) FROM Post;

2. X√≥a d·ªØ li·ªáu (c·∫©n th·∫≠n!)
   DELETE FROM Pagoda WHERE _id = 1;

3. C·∫≠p nh·∫≠t d·ªØ li·ªáu
   UPDATE Pagoda SET name = N'T√™n m·ªõi' WHERE _id = 1;

4. Th√™m d·ªØ li·ªáu m·ªõi
   INSERT INTO Pagoda (name, address, category_id) 
   VALUES (N'Ch√πa m·ªõi', N'ƒê·ªãa ch·ªâ', 1);

5. Xem c·∫•u tr√∫c b·∫£ng
   EXEC sp_help 'Pagoda';

================================================================================
üêõ TROUBLESHOOTING
================================================================================

L·ªói: "CREATE VIEW must be the first statement"
  ‚Üí Ch·∫°y file 02_CREATE_VIEWS.sql ri√™ng bi·ªát

L·ªói: "CREATE PROCEDURE must be the first statement"
  ‚Üí Ch·∫°y file 03_CREATE_PROCEDURES.sql ri√™ng bi·ªát

L·ªói: "Database already exists"
  ‚Üí X√≥a database c≈© ho·∫∑c ƒë·ªïi t√™n database

L·ªói: "Foreign key constraint"
  ‚Üí Ki·ªÉm tra category_id t·ªìn t·∫°i trong Category

================================================================================
üìû LI√äN H·ªÜ & H·ªñ TR·ª¢
================================================================================

N·∫øu g·∫∑p v·∫•n ƒë·ªÅ:
1. Ki·ªÉm tra l·∫°i c√°c b∆∞·ªõc
2. Xem error message
3. Ch·∫°y t·ª´ng file ri√™ng bi·ªát
4. Ki·ªÉm tra d·ªØ li·ªáu m·∫´u

================================================================================
‚úÖ CHECKLIST
================================================================================

- [ ] Ch·∫°y 01_CREATE_DATABASE.sql
- [ ] Ch·∫°y 02_CREATE_VIEWS.sql
- [ ] Ch·∫°y 03_CREATE_PROCEDURES.sql
- [ ] Ki·ªÉm tra database ƒë∆∞·ª£c t·∫°o
- [ ] Ki·ªÉm tra b·∫£ng ƒë∆∞·ª£c t·∫°o
- [ ] Ki·ªÉm tra d·ªØ li·ªáu m·∫´u
- [ ] Ch·∫°y queries th·ª≠ nghi·ªám
- [ ] Ki·ªÉm tra views
- [ ] Ki·ªÉm tra procedures

================================================================================
üéâ HO√ÄN TH√ÄNH!
================================================================================

Database TRA_VINH_PAGODA ƒë√£ s·∫µn s√†ng s·ª≠ d·ª•ng!

B∆∞·ªõc ti·∫øp theo:
1. K·∫øt n·ªëi database v·ªõi backend (Node.js, Python, etc.)
2. T·∫°o API endpoints
3. K·∫øt n·ªëi v·ªõi React frontend

================================================================================
